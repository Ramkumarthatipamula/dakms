<h3>Dashboard - Uploaded Activities / Projects</h3>
<% if current_user.discipline != 'Teaching' %>
<div class="item_wrap">
  <div class="item">
    <form action="/institute/dashboard">

        <select name="name" class="form-control" onchange="this.form.submit()">
          <option value="">Select Activities/Projects</option>
          <option value="Project" <%= 'selected' if params[:name] == 'Project' %>>Projects</option>
          <option value="Activity" <%= 'selected' if params[:name] == 'Activity' %>>Activities</option>
        </select>
    </form>
  </div>
</div>
<% end %>
<br>
<% if @upload_files.present? %>
  <div class="item_wrap">
    <div class="item">
      <div class="table-responsive">
        <table id="static-table" class="table table-striped table-hover dt-responsive display nowrap " cellspacing="0">
          <thead>
            <tr>
              <th>S.No.</th>
              <th>Discipline</th>
              <th>Title</th>
              <th>Location</th>
              <th>Date</th>
              <th>Scientist</th>
              <th>Posted Date</th>
              <th>Status(EW)</th>
              <th>File Type</th>
              <th>Attachment</th>
              <th>Re Upload</th>
            </tr>
          </thead>
          <tbody>
            <% @upload_files.each_with_index do |upload_file, index| %>
              <tr>
                <td><%= index+1 %></td>
                <td><%= upload_file.institute.discipline if upload_file.institute.present? %></td>
                <td><%= upload_file.title %></td>
                <td><%= upload_file.location %></td>
                <td><%= upload_file.date.in_time_zone("Kolkata").strftime("%d-%m-%Y") %></td>
                <td><%= upload_file.scientist_name %></td>
                <td><%= upload_file.created_at.in_time_zone("Kolkata").strftime("%d-%m-%Y") %></td>
                <td><%= upload_file.status %></td>
                <td><%= upload_file.file_type %></td>
                <td>
                  <% if upload_file.file.attached? %>
                    <%= link_to 'Download', upload_file.file, class: "btn btn-success btn-sm", target: '_blank' %>
                  <% else %>
                    <%#= link_to 'Download', "#", method: :get, class: "btn btn-success btn-sm" %>
                  <% end %>
                  <%#= link_to 'Download', upload_file_path(format: :zip, id: upload_file.id), method: :get, class: "btn btn-success btn-sm" %>
                  <%#= link_to 'Download', approved_files_download_path(id: upload_file.id), class: 'btn btn-info btn-sm' %>
                </td>
                  <td>
                    <% if upload_file.status == 'Rejected' %>
                    <%= link_to 'Re Upload', upload_file_status_update_path(status: 'Pending', id: upload_file.id), class: 'btn btn-success btn-sm' %>
                    <% end %>
                  </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% elsif !@upload_files.nil? %>
  <p class="alert alert-warning">No records found</p>
<% end %>

<script>
$(document).ready( function () {
  $('#static-table').DataTable( {
    responsive: true
  });
});
</script>
