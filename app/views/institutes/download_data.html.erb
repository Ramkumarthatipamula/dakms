<h3>Downloads</h3>
<% if current_user.type != "Institute"%>
  <div class="item_wrap">
    <div class="item" align="center">
      <div class="col-8">
        <form action="/electronic_wing/download_data">
            <!-- <label for="displaying"></label> -->
            <select name="user_id" class="form-control" onchange="this.form.submit()">
              <option value="">Select Institute / Centre</option>
              <% @users.each do |bt|%>
                <option value="<%= bt.id %>" <%= 'selected' if params[:user_id].to_i == bt.id %>> <%= bt.institute_centre_name %></option>
              <% end %>
            </select>
          <!-- <label for="displaying">Select</label> -->
          <select name="type" class="form-control" onchange="this.form.submit()">
            <option value="">Select</option>
            <option value="Activity" <%= 'selected' if params[:type].to_s == 'Activity' %>>Activities</option>
            <option value="Project" <%= 'selected' if params[:type].to_s == 'Project' %>>Projects</option>
          </select>
        </form>
      </div>
    </div>
  </div>
<% end %>
<br>
<% if @upload_files.present? %>
  <div class="item_wrap">
    <div class="item">
      <div class="table-responsive">
        <table id="static-table" class="table table-striped table-hover dt-responsive display nowrap " cellspacing="0">
          <thead>
            <tr>
              <th>S.No:</th>
              <% if current_user.discipline == 'Teaching' %>
                <th>Activity Type</th>
              <% else %>
                <th>Project/Activity</th>
              <% end %>
              <th>Discipline</th>
              <th>Title</th>
              <th>Location</th>
              <th>Date</th>
              <th>Scientist</th>
              <th>Posted Date</th>
              <th>File Type</th>
              <th>Attachment</th>
            </tr>
          </thead>
          <tbody>
            <% @upload_files.each_with_index do |upload_file, index| %>
              <tr>
                <td><%= index+1 %></td>
                <td><%= upload_file.upload_type %></td>
                <td><%= upload_file.discipline %></td>
                <td><%= upload_file.title %></td>
                <td><%= upload_file.location %></td>
                <td><%= upload_file.date.in_time_zone("Kolkata").strftime("%d-%m-%Y") %></td>
                <td><%= upload_file.scientist_name %></td>
                <td><%= upload_file.created_at.in_time_zone("Kolkata").strftime("%d-%m-%Y") %></td>
                <td><%= upload_file.file_type %></td>
                <td>
                  <% if upload_file.file.attached? %>
                    <%= link_to 'Download', url_for(upload_file.file), method: :get, class: "btn btn-success btn-sm", target: '_blank' %>
                  <% else %>
                    <%#= link_to 'Download', "#", method: :get, class: "btn btn-success btn-sm" %>
                  <% end %>
                  <%#= link_to 'Download', upload_file_path(format: :zip, id: upload_file.id), method: :get, class: "btn btn-success btn-sm" %>
                  <%#= link_to 'Download', approved_files_download_path(id: upload_file.id), class: 'btn btn-info' %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% elsif !@upload_files.nil? %>
  <p class="alert alert-warning">No records found</p>
<% end %>

<script>
$(document).ready( function () {
  $('#static-table').DataTable( {
    responsive: true
  });
});
</script>
